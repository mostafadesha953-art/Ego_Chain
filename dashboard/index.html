<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>EgoChain Core | Sovereign Ecosystem</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com">
    <style>
        :root { --gold: #d4af37; --dark: #050505; --card: #121212; --green: #25d366; --danger: #ff4b2b; }
        body { background: var(--dark); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 280px; background: var(--card); border-left: 1px solid #222; display: flex; flex-direction: column; padding: 20px; }
        .nav-link { padding: 12px; margin: 5px 0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; color: #888; font-size: 14px; border: 1px solid transparent; transition: 0.3s; }
        .nav-link.active { background: #1a1a1a; color: var(--gold); border-color: var(--gold); }
        .nav-link i { margin-left: 12px; width: 18px; }
        .auth-panel { background: #0a0a0a; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; }
        input { width: 100%; padding: 10px; margin: 5px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 6px; font-size: 11px; box-sizing: border-box; }
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        .viewport { display: none; }
        .viewport.active { display: block; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #222; margin-bottom: 20px; }
        .btn-gold { background: var(--gold); color: #000; font-weight: bold; border: none; padding: 12px; border-radius: 6px; cursor: pointer; width: 100%; }
        #user-tag { font-size: 10px; color: var(--green); text-align: center; margin-bottom: 10px; display: none; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2 style="color:var(--gold); text-align:center;">EGO CHAIN</h2>
        <div id="user-tag"><i class="fas fa-user-shield"></i> Ù…ØªØµÙ„: <span id="display-id"></span></div>
        
        <div class="auth-panel">
            <input type="text" id="in-id" placeholder="Ø§Ù„Ù‡ÙˆÙŠØ©">
            <input type="password" id="in-pass" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ">
            <input type="password" id="in-key" placeholder="Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ">
            <button class="btn-gold" style="margin-top:10px;" onclick="attemptLogin()">Ø¯Ø®ÙˆÙ„ Ø³ÙŠØ§Ø¯ÙŠ</button>
        </div>

        <div id="btn-home" class="nav-link active" onclick="showPage('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div id="btn-wallet" class="nav-link" onclick="showPage('wallet')"><i class="fas fa-wallet"></i> Ù…Ø­ÙØ¸ØªÙŠ</div>
        <div id="btn-factory" class="nav-link" onclick="showPage('factory')"><i class="fas fa-file-contract"></i> Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø´ÙØ±Ø©</div>
    </div>

    <div class="main-content">
        <div id="page-home" class="viewport active">
            <div class="card">
                <h2>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</h2>
                <p style="color:#888">ØªØµÙØ­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¢Ù…Ù† ÙˆÙ…Ø´ÙØ± Ø¨Ù…ÙˆØ¬Ø¨ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ EgoChain.</p>
            </div>
        </div>

        <div id="page-wallet" class="viewport">
            <div class="card">
                <h3>Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©</h3>
                <p>AURA: <span id="u-aura">0.00</span> | USDT: <span id="u-usdt">0.00</span></p>
            </div>
        </div>

        <div id="page-factory" class="viewport">
            <div class="card">
                <h3>ØªÙˆÙ„ÙŠØ¯ Ø¹Ù‚Ø¯ Ø®Ø§Øµ</h3>
                <input type="text" id="c-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù‚Ø¯">
                <button class="btn-gold" onclick="generatePrivateContract()">ØªÙˆÙ„ÙŠØ¯ ÙˆØ­ÙØ¸</button>
                <div id="contracts-list" style="margin-top:20px; font-size:11px;"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ØªØ¹Ù…Ù„ Ø£ÙˆÙ„Ø§Ù‹ ---
        function showPage(id) {
            const views = document.querySelectorAll('.viewport');
            views.forEach(v => v.classList.remove('active'));
            const links = document.querySelectorAll('.nav-link');
            links.forEach(l => l.classList.remove('active'));
            
            document.getElementById('page-' + id).classList.add('active');
            document.getElementById('btn-' + id).classList.add('active');
        }

        let session = { id: null, key: null };

        function attemptLogin() {
            const id = document.getElementById('in-id').value;
            const key = document.getElementById('in-key').value;
            if(!id || !key) return alert("Ø§Ù„Ù…Ø¹Ø·ÙŠØ§Øª Ù†Ø§Ù‚ØµØ©!");
            
            session = { id, key };
            document.getElementById('user-tag').style.display = 'block';
            document.getElementById('display-id').innerText = id;
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø®ÙÙŠØ© Ø¹Ù† Netlify
            window.postMessage({ type: 'EGO_LOGIN', auth: {id, key} }, "*");
            alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø­Ù„ÙŠØ§Ù‹.");
        }

        function generatePrivateContract() {
            if(!session.id) return alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„!");
            const name = document.getElementById('c-name').value;
            alert("ğŸ”’ ØªÙ… ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯ Ø±Ù‚Ù…ÙŠØ§Ù‹: " + name);
        }

        // --- 2. Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Electron Ø¨Ø¯ÙˆÙ† ÙƒØ³Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ ---
        (function() {
            try {
                // ØªÙ…ÙˆÙŠÙ‡ ÙƒÙ„Ù…Ø© require Ù„Ù…Ù†Ø¹ Netlify Ù…Ù† Ø­Ø¸Ø± Ø§Ù„ÙƒÙˆØ¯
                const req = window["require"]; 
                if (req) {
                    const ipc = req('electron').ipcRenderer;
                    window.addEventListener("message", (event) => {
                        if (event.data.type === 'EGO_LOGIN') {
                            ipc.send('request-secure-login', event.data.auth);
                        }
                    });
                    ipc.on('login-success', (event, data) => {
                        document.getElementById('u-aura').innerText = data.balances.AURA;
                        document.getElementById('u-usdt').innerText = data.balances.USDT;
                    });
                }
            } catch (e) {
                console.log("Sovereign Network: Web View Active");
            }
        })();
    </script>
</body>
</html>
