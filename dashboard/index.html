<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>EgoChain Sovereign | Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ù†Ø¹Ø²Ø§Ù„ Ø§Ù„ØªØ§Ù…</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com">
    <style>
        :root { --gold: #d4af37; --dark: #050505; --card: #121212; --green: #25d366; --danger: #ff4b2b; }
        body { background: var(--dark); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 280px; background: var(--card); border-left: 1px solid #222; display: flex; flex-direction: column; padding: 20px; }
        .nav-link { padding: 12px; margin: 5px 0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; color: #888; font-size: 14px; border: 1px solid transparent; }
        .nav-link.active { background: #1a1a1a; color: var(--gold); border-color: var(--gold); }
        .auth-panel { background: #0a0a0a; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; }
        input { width: 100%; padding: 10px; margin: 5px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 6px; font-size: 11px; box-sizing: border-box; }
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        .viewport { display: none; }
        .viewport.active { display: block; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #222; margin-bottom: 20px; }
        .btn-gold { background: var(--gold); color: #000; font-weight: bold; border: none; padding: 12px; border-radius: 6px; cursor: pointer; width: 100%; }
        #user-tag { font-size: 10px; color: var(--green); text-align: center; margin-bottom: 10px; display: none; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2 style="color:var(--gold); text-align:center;">EGO CHAIN</h2>
        <div id="user-tag"><i class="fas fa-user-shield"></i> Ù…ØªØµÙ„: <span id="display-id"></span></div>
        
        <div class="auth-panel">
            <input type="text" id="in-id" placeholder="Ø§Ù„Ù‡ÙˆÙŠØ© (Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„/Ø§Ù„Ù‡Ø§ØªÙ)">
            <input type="password" id="in-pass" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ">
            <input type="password" id="in-key" placeholder="Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ (Ø§Ù„ØªÙˆÙ‚ÙŠØ¹)">
            <button class="btn-gold" style="margin-top:10px;" onclick="attemptLogin()">Ø¯Ø®ÙˆÙ„ Ø³ÙŠØ§Ø¯ÙŠ</button>
        </div>

        <div class="nav-link active" onclick="showPage('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div class="nav-link" onclick="showPage('wallet')"><i class="fas fa-wallet"></i> Ù…Ø­ÙØ¸ØªÙŠ Ø§Ù„Ø®Ø§ØµØ©</div>
        <div class="nav-link" onclick="showPage('factory')"><i class="fas fa-file-contract"></i> Ø¹Ù‚ÙˆØ¯ÙŠ Ø§Ù„Ù…Ø´ÙØ±Ø©</div>
    </div>

    <div class="main-content">
        <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø© -->
        <div id="page-wallet" class="viewport active">
            <div class="card">
                <h3>Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</h3>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                    <div class="card" style="text-align:center"><h4>AURA</h4><div id="u-aura" class="stat-val" style="font-size:24px; color:var(--gold)">0.00</div></div>
                    <div class="card" style="text-align:center"><h4>USDT</h4><div id="u-usdt" class="stat-val" style="font-size:24px; color:var(--green)">0.00</div></div>
                </div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø´ÙØ±Ø© -->
        <div id="page-factory" class="viewport">
            <div class="card">
                <h3>Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù‚Ø¯ Ø°ÙƒÙŠ Ø¬Ø¯ÙŠØ¯ (Private)</h3>
                <input type="text" id="c-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù‚Ø¯">
                <button class="btn-gold" onclick="generatePrivateContract()">ØªÙˆÙ„ÙŠØ¯ ÙˆØ­ÙØ¸ ÙÙŠ Ø³Ø¬Ù„ÙŠ</button>
                <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
                <h4>Ø¹Ù‚ÙˆØ¯ÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:</h4>
                <div id="contracts-list" style="font-size:11px; color:#aaa;">Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙØ§Ø±Øº..</div>
            </div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = (typeof require !== 'undefined') ? require('electron') : { ipcRenderer: null };
        let session = { id: null, key: null };

        function showPage(p) {
            document.querySelectorAll('.viewport').forEach(v => v.classList.remove('active'));
            document.getElementById('page-' + p).classList.add('active');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ
        function attemptLogin() {
            const auth = {
                id: document.getElementById('in-id').value,
                pass: document.getElementById('in-pass').value,
                key: document.getElementById('in-key').value
            };
            if(!auth.id || !auth.key) return alert("Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ Ù…Ø·Ù„ÙˆØ¨!");
            
            if(ipcRenderer) {
                ipcRenderer.send('request-secure-login', auth);
                session = auth;
            }
        }

        // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø·
        if(ipcRenderer) {
            ipcRenderer.on('login-success', (event, data) => {
                document.getElementById('user-tag').style.display = 'block';
                document.getElementById('display-id').innerText = session.id;
                document.getElementById('u-aura').innerText = data.balances.AURA.toLocaleString();
                document.getElementById('u-usdt').innerText = data.balances.USDT.toFixed(2);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø·
                const list = document.getElementById('contracts-list');
                list.innerHTML = data.history.length ? '' : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚ÙˆØ¯ Ù…Ø³Ø¬Ù„Ø© Ø¨Ø§Ø³Ù…Ùƒ.';
                data.history.forEach(c => {
                    list.innerHTML += <div class="card" style="padding:10px; margin-bottom:5px;"><b>${c.name}</b><br>${c.contract_id}</div>;
                });
                alert("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ù…Ø´ÙØ±Ø© Ø¨Ù†Ø¬Ø§Ø­.");
            });

            ipcRenderer.on('auth-error', (event, msg) => alert(msg));
        }

        function generatePrivateContract() {
            if(!session.id) return alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!");
            const name = document.getElementById('c-name').value;
            const contract = {
                contract_id: "SC-" + Date.now(),
                owner: session.id, // Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…Ø§Ù„Ùƒ
                name: name,
                timestamp: new Date().toISOString()
            };
            ipcRenderer.send('save-private-contract', contract);
            alert("ğŸ”’ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯ ÙÙŠ Ø³Ø¬Ù„Ùƒ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ Ø§Ù„Ø®Ø§Øµ.");
        }
    </script>
</body>
</html>
